# Guide Pratique: D√©veloppement DO-178C avec Claude Code
## Workflow Quotidien pour AISET

---

## üéØ Principe Fondamental

**Claude Code est un assistant, PAS un d√©veloppeur autonome.**

Avec DO-178C, vous devez :
1. ‚úÖ Toujours reviewer le code g√©n√©r√©
2. ‚úÖ Documenter l'usage de l'outil
3. ‚úÖ Tracer le code aux exigences
4. ‚úÖ Tester tout le code (g√©n√©r√© ou manuel)

---

## üìã Checklist Avant Chaque Session Claude Code

### Pr√©paration
- [ ] J'ai identifi√© l'exigence que j'impl√©mente (ex: REQ-045)
- [ ] J'ai lu le design associ√© (ex: LLD Section 3.2)
- [ ] J'ai un test plan pour cette fonctionnalit√©
- [ ] J'ai pr√©par√© mes crit√®res d'acceptation

### Environnement
- [ ] Git status est propre (pas de changements non committ√©s)
- [ ] Je suis sur une branche feature d√©di√©e
- [ ] Mes d√©pendances sont √† jour

### Documentation
- [ ] J'ai un template de code review pr√™t
- [ ] J'ai acc√®s √† la matrice de tra√ßabilit√©

---

## üîÑ Workflow √âtape par √âtape

### √âTAPE 1: D√©finir l'Exigence

**Avant de demander √† Claude Code de g√©n√©rer du code, documentez:**

```markdown
## Work Item: Implement AI Requirements Extraction

### Requirement
- **ID:** REQ-045
- **Title:** AI shall extract requirements from user responses
- **Description:** The system shall use AI to parse natural language 
  user responses and extract structured requirements with title, 
  description, type, and priority.

### Design Reference
- **HLD:** Section 3.1 - AI Service Architecture
- **LLD:** Section 3.2.4 - Requirements Parser Module

### Acceptance Criteria
1. Function accepts user text input
2. Returns structured JSON with requirements
3. Each requirement has confidence score
4. Handles empty/invalid input gracefully
5. Response time < 5 seconds

### Test Cases
- TC-045-001: Valid input with single requirement
- TC-045-002: Valid input with multiple requirements  
- TC-045-003: Empty input
- TC-045-004: Invalid/ambiguous input
```

**üíæ Sauvegardez ceci dans:** `02_REQUIREMENTS/REQ-045_Implementation_Plan.md`

---

### √âTAPE 2: Prompt Structur√© pour Claude Code

**‚ùå MAUVAIS Prompt (non-conforme DO-178C):**
```
√âcris-moi une fonction qui extrait des requirements depuis du texte
```

**‚úÖ BON Prompt (conforme DO-178C):**
```
Je dois impl√©menter la fonction suivante conforme DO-178C:

REQUIREMENT: REQ-045 - AI shall extract requirements from user responses

DESIGN: (coller extrait du LLD)
Module: AIService
Function: extract_requirements(user_response: str, context: Dict) -> Dict

CODING STANDARDS TO FOLLOW:
1. PEP 8 compliant
2. Type hints mandatory
3. Docstring with traceability
4. Error handling with specific exceptions
5. Max cyclomatic complexity: 10
6. No use of eval/exec

INPUT VALIDATION REQUIRED:
- user_response: non-empty string
- context: must contain 'project_id' key

OUTPUT SPECIFICATION:
{
  "requirements": [
    {
      "title": str (max 80 chars),
      "description": str,
      "type": "functional" | "non_functional",
      "priority": "critical" | "high" | "medium" | "low",
      "confidence": float (0.0-1.0)
    }
  ],
  "errors": [str]
}

ERROR HANDLING:
- Raise ValueError for empty input
- Raise AIServiceError for AI call failures
- Log all errors with context

PLEASE GENERATE:
1. The function implementation
2. Unit tests (pytest)
3. Docstring with REQ-045 traceability
```

---

### √âTAPE 3: Revue du Code G√©n√©r√© (OBLIGATOIRE)

**Utilisez cette checklist pour CHAQUE fichier g√©n√©r√©:**

#### üìù Code Review Checklist

**File:** `backend/services/ai_service.py::extract_requirements()`
**Generated by:** Claude Code
**Date:** 2025-11-14
**Reviewer:** [Your Name]

##### ‚úÖ Conformit√© aux Standards
- [ ] Naming conventions respect√©es (snake_case, PascalCase)
- [ ] Type hints pr√©sents sur tous les arguments/retours
- [ ] Docstring compl√®te avec Args/Returns/Raises
- [ ] Traceability comment pr√©sent (# REQ-045)
- [ ] Pas d'utilisation de constructs interdits (eval, exec, etc.)
- [ ] Complexit√© cyclomatique < 10
- [ ] Longueur fonction < 50 lignes

##### ‚úÖ Fonctionnalit√©
- [ ] Logique correcte par rapport au design
- [ ] Gestion des cas d'erreur
- [ ] Input validation impl√©ment√©e
- [ ] Output conforme √† la sp√©cification
- [ ] Performance acceptable (< 5s)

##### ‚úÖ S√©curit√©
- [ ] Pas d'injection SQL/code
- [ ] Input sanitization
- [ ] Pas d'exposition de donn√©es sensibles dans logs
- [ ] Gestion s√©curis√©e des exceptions

##### ‚úÖ Testabilit√©
- [ ] Fonctions pures (pas d'effets de bord inutiles)
- [ ] Dependencies injectables
- [ ] Mocking possible
- [ ] Tests unitaires g√©n√©r√©s

##### ‚úÖ Tra√ßabilit√©
- [ ] Lien vers requirement clair
- [ ] Lien vers design document clair
- [ ] Changement enregistr√© dans Git avec message tra√ßable

##### ‚ùì Questions/Pr√©occupations
```
[Note any concerns here]
```

##### üéØ D√©cision
- [ ] **APPROVED** - Code int√©gr√© sans modification
- [ ] **APPROVED WITH CHANGES** - Modifications mineures requises
- [ ] **REJECTED** - Re-g√©n√©rer avec nouveau prompt

**Signature:** _______________  **Date:** _______________

---

### √âTAPE 4: Modifier le Code (si n√©cessaire)

**Si le code n√©cessite des changements:**

1. **NE PAS modifier directement le code g√©n√©r√©**
2. **Cr√©er un nouveau prompt** avec les corrections demand√©es
3. **Documenter POURQUOI** la premi√®re g√©n√©ration √©tait incorrecte

Exemple:
```markdown
## Code Generation Iteration Log

### Iteration 1
- **Prompt:** [original prompt]
- **Issue:** Missing input validation for empty string
- **Action:** Rejected, new prompt created

### Iteration 2  
- **Prompt:** [updated prompt with validation requirement]
- **Result:** Approved
- **File:** backend/services/ai_service.py (commit abc123)
```

---

### √âTAPE 5: Tests (OBLIGATOIRE)

**TOUS les tests doivent passer avant commit:**

```bash
# 1. Tests unitaires
pytest tests/unit/test_ai_service.py -v --cov=backend/services/ai_service --cov-report=term

# Target: >90% coverage

# 2. V√©rifier la complexit√©
radon cc backend/services/ai_service.py -a

# Target: Average complexity A or B

# 3. Type checking
mypy backend/services/ai_service.py

# Target: No errors

# 4. Linting
pylint backend/services/ai_service.py

# Target: Score > 9.0/10
```

**üìä Documenter les r√©sultats:**

```markdown
## Test Results - REQ-045 Implementation

### Unit Tests
- **Status:** ‚úÖ PASSED
- **Coverage:** 95%
- **Tests Run:** 12
- **Tests Passed:** 12
- **Date:** 2025-11-14

### Static Analysis
- **Cyclomatic Complexity:** Average 4.2 (Grade A)
- **Maintainability Index:** 78 (Good)

### Type Checking
- **Status:** ‚úÖ PASSED
- **Errors:** 0

### Linting
- **Score:** 9.5/10
- **Issues:** 2 minor (documentation)
```

**üíæ Sauvegardez:** `05_VERIFICATION/Test_Results/REQ-045_Test_Report.md`

---

### √âTAPE 6: Tra√ßabilit√© (CRITIQUE)

**Mettez √† jour la matrice de tra√ßabilit√©:**

| Req ID | Req Title | Design Ref | Code File | Test Cases | Status |
|--------|-----------|------------|-----------|------------|--------|
| REQ-045 | AI Requirements Extraction | LLD-3.2.4 | backend/services/ai_service.py::extract_requirements() | TC-045-001 to TC-045-004 | ‚úÖ VERIFIED |

**Commande Git avec tra√ßabilit√©:**

```bash
git add backend/services/ai_service.py tests/unit/test_ai_service.py
git commit -m "feat(ai): implement requirements extraction [REQ-045]

- Implemented extract_requirements() function
- Added comprehensive input validation
- Unit tests with 95% coverage
- Traceability: REQ-045 -> LLD-3.2.4 -> Code
- Generated with: Claude Code (reviewed and approved)
- Reviewer: [Your Name]
- Test Report: 05_VERIFICATION/Test_Results/REQ-045_Test_Report.md

DO-178C Compliance:
- Code review completed (SDP Section 4.3)
- Coding standards verified (SDP Section 3.1.1)
- Unit tests passed (SVP Section 5.1)
- Traceability updated (SDP Section 5.2)
"
```

---

### √âTAPE 7: Documentation de l'Utilisation d'Outil

**Pour chaque session Claude Code, documenter:**

```markdown
## AI Tool Usage Record

**Date:** 2025-11-14
**Tool:** Claude Code (Anthropic)
**Tool Version:** Latest (as of date)
**User:** [Your Name]

### Purpose
Implement REQ-045: AI Requirements Extraction

### Prompt Used
[Coller le prompt complet]

### Code Generated
- **Files:** backend/services/ai_service.py, tests/unit/test_ai_service.py
- **Lines of Code:** 120 (source), 180 (tests)

### Review Process
- **Reviewer:** [Your Name]
- **Review Date:** 2025-11-14
- **Review Checklist:** Completed (see code_review_REQ045.md)
- **Issues Found:** 1 (missing edge case handling)
- **Resolution:** Re-generated with updated prompt

### Verification
- **Unit Tests:** PASSED (95% coverage)
- **Integration Tests:** PASSED
- **Static Analysis:** PASSED
- **Code Review:** APPROVED

### Traceability
- **Requirement:** REQ-045
- **Design:** LLD Section 3.2.4
- **Tests:** TC-045-001 to TC-045-004
- **Commit:** abc123def456

### Tool Qualification Status
- **Status:** QUALIFIED (see Tool_Qualification_Report.md)
- **Confidence:** HIGH (tool has passed 500+ verification tests)

### Approver Signature
_______________  Date: _______________
```

**üíæ Sauvegardez:** `04_SOURCE_CODE/AI_Tool_Usage/REQ-045_Claude_Usage.md`

---

## üö´ Interdictions ABSOLUES

### ‚ùå NE JAMAIS FAIRE

1. **Int√©grer du code non-review√©**
   ```bash
   # INTERDIT
   claude generate code.py && git add code.py && git commit -m "done"
   ```

2. **Utiliser Claude Code pour du code critique sans test**
   - Tout code DOIT avoir des tests
   - Coverage minimum: 90%

3. **G√©n√©rer du code sans exigence**
   - Chaque ligne de code DOIT tracer √† une exigence

4. **Copier-coller sans comprendre**
   - Si vous ne comprenez pas le code, NE PAS l'int√©grer

5. **Sauter la documentation**
   - Chaque utilisation d'outil DOIT √™tre document√©e

---

## ‚úÖ Bonnes Pratiques

### 1. Utiliser Claude Code pour les T√¢ches Appropri√©es

**‚úÖ BON Usage:**
- Boilerplate code (CRUD, endpoints)
- Tests unitaires
- Documentation (docstrings)
- Refactoring (avec tests existants)
- Parsing de donn√©es

**‚ùå MAUVAIS Usage:**
- Algorithmes critiques de s√©curit√©
- Logique business complexe (sans validation extensive)
- G√©n√©ration de tests d'int√©gration end-to-end
- D√©cisions architecturales

### 2. It√©ration Incr√©mentale

**Au lieu de:**
```
"Generate complete AI service with database, API, and tests"
```

**Faire:**
```
Session 1: "Generate data models for AI entities"
Review ‚úÖ
Session 2: "Generate database access layer"  
Review ‚úÖ
Session 3: "Generate API endpoints"
Review ‚úÖ
```

### 3. Templates de Prompts

**Cr√©ez des prompts r√©utilisables:**

```markdown
## Template: Generate Python Function (DO-178C)

REQUIREMENT: [REQ-ID] - [Requirement text]

DESIGN REFERENCE: [LLD Section X.Y.Z]

FUNCTION SIGNATURE:
```python
def function_name(arg1: Type1, arg2: Type2) -> ReturnType:
    """[Description]"""
```

CODING STANDARDS:
[Reference to SDP Section 3.1.1]

INPUT VALIDATION:
- [List validation rules]

OUTPUT SPECIFICATION:
- [Describe expected output]

ERROR HANDLING:
- [List exception scenarios]

PERFORMANCE REQUIREMENTS:
- [Specify limits]

GENERATE:
1. Function implementation
2. Docstring with traceability
3. Unit tests (pytest)
4. Type hints
5. Error handling
```

---

## üìä M√©triques de Qualit√©

**Suivez ces m√©triques pour chaque module:**

| Metric | Target | RED Flag |
|--------|--------|----------|
| Code Coverage | >90% | <80% |
| Cyclomatic Complexity | <10 | >15 |
| Maintainability Index | >70 | <50 |
| Pylint Score | >9.0 | <8.0 |
| Type Checking Errors | 0 | >5 |
| Code Review Time | <2h/PR | >4h/PR |

---

## üîß Outils de Support

### Scripts d'Automatisation

**1. Script de Pre-Commit (√† ajouter √† `.git/hooks/pre-commit`):**

```bash
#!/bin/bash

echo "üîç Running DO-178C Pre-Commit Checks..."

# 1. Tests unitaires
echo "üìù Running unit tests..."
pytest tests/unit/ -q || {
    echo "‚ùå Unit tests failed!"
    exit 1
}

# 2. Coverage
echo "üìä Checking code coverage..."
coverage run -m pytest tests/unit/
coverage report --fail-under=90 || {
    echo "‚ùå Coverage below 90%!"
    exit 1
}

# 3. Type checking
echo "üî§ Running type checks..."
mypy backend/ || {
    echo "‚ùå Type errors found!"
    exit 1
}

# 4. Linting
echo "‚ú® Running linter..."
pylint backend/ --fail-under=9.0 || {
    echo "‚ùå Linting score below 9.0!"
    exit 1
}

# 5. Complexity
echo "üßÆ Checking complexity..."
radon cc backend/ -a -nb || {
    echo "‚ö†Ô∏è Complexity check failed!"
}

echo "‚úÖ All pre-commit checks passed!"
```

**2. Script de G√©n√©ration de Documentation:**

```python
# scripts/generate_traceability.py
"""
Generate traceability matrix from code comments and tests
"""

import re
import json
from pathlib import Path

def extract_req_ids_from_code(file_path):
    """Extract requirement IDs from code file"""
    with open(file_path) as f:
        content = f.read()
    
    # Search for REQ-XXX patterns
    pattern = r'REQ-\d{3}'
    return set(re.findall(pattern, content))

def generate_matrix():
    """Generate complete traceability matrix"""
    matrix = []
    
    # Scan all Python files
    for py_file in Path('backend').rglob('*.py'):
        req_ids = extract_req_ids_from_code(py_file)
        
        for req_id in req_ids:
            matrix.append({
                'requirement': req_id,
                'code_file': str(py_file),
                'status': 'IMPLEMENTED'
            })
    
    # Output to JSON
    with open('08_TRACEABILITY/traceability_matrix.json', 'w') as f:
        json.dump(matrix, f, indent=2)
    
    print(f"‚úÖ Generated traceability matrix with {len(matrix)} entries")

if __name__ == '__main__':
    generate_matrix()
```

---

## üìö R√©f√©rences Rapides

### Standards de Code
- **Python:** `/01_PLANNING/Standards/Python_Coding_Standard.md`
- **TypeScript:** `/01_PLANNING/Standards/TypeScript_Coding_Standard.md`

### Templates
- **Code Review:** `/04_SOURCE_CODE/Code_Reviews/Code_Review_Template.md`
- **Test Plan:** `/05_VERIFICATION/Test_Plans/Test_Plan_Template.md`

### Checklists
- **Pre-Commit:** `.github/workflows/pre-commit.yml`
- **Code Review:** `/07_QUALITY_ASSURANCE/Checklists/Code_Review_Checklist.md`

---

## üéì Formation Recommand√©e

### Pour l'√âquipe

1. **DO-178C Overview** (1 jour)
   - Comprendre les objectifs
   - Comprendre la tra√ßabilit√©
   - Comprendre le r√¥le des outils

2. **Tool Qualification** (0.5 jour)
   - Claude Code qualification approach
   - Documentation requirements
   - Review processes

3. **Coding Standards** (0.5 jour)
   - Python/TypeScript standards
   - Review best practices
   - Common pitfalls

---

## üìû Support

**Questions sur DO-178C:**
- Consulter DO-178C document (Section X)
- Demander au Compliance Officer

**Questions sur Claude Code:**
- Documentation Anthropic
- Internal tool wiki

**Probl√®mes Techniques:**
- Ouvrir un ticket dans Jira
- Tag: `do178c-compliance`

---

## üìÖ Checklist Hebdomadaire de Conformit√©

**√Ä faire chaque fin de semaine:**

- [ ] Mettre √† jour la matrice de tra√ßabilit√©
- [ ] V√©rifier que tous les commits ont des REQ-ID
- [ ] V√©rifier que tous les code reviews sont compl√©t√©s
- [ ] G√©n√©rer le rapport de couverture de tests
- [ ] Archiver les logs d'utilisation d'outils
- [ ] V√©rifier que la documentation est √† jour

---

**Version:** 1.0  
**Date:** 14 Novembre 2025  
**Maintenu par:** Compliance Team  
**Contact:** compliance@aiset.com
